<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMARTPAT - 스마트 보정 플랫폼</title>
    
    <!-- 메타태그 -->
    <meta name="description" content="SMARTPAT - 변리사를 위한 스마트 보정 플랫폼. 보정이력 검증과 청구항 점검.">
    <meta name="keywords" content="SMARTPAT, 스마트보정, 보정서, 청구항점검, 변리사, 특허">
    <meta name="author" content="SMARTPAT">
    <meta property="og:title" content="SMARTPAT - 스마트 보정 플랫폼">
    <meta property="og:description" content="변리사를 위한 AI 기반 보정서 작성과 청구항 점검 도구">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://smartpat.co.kr">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="SMARTPAT - 스마트 보정 플랫폼">
    <meta name="twitter:description" content="변리사를 위한 스마트 보정 도구">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⚡</text></svg>">
    
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1E3A8A 0%, #3B82F6 50%, #60A5FA 100%);
            color: #333;
            height: 100vh;
            overflow: hidden;
            font-size: 13px;
            position: relative;
        }

        /* 배경 플로우 화살표 */
        body::before {
            content: '';
            position: absolute;
            top: 15%;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 600px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 200'%3E%3Cpath d='M50 10 L50 160 M35 145 L50 160 L65 145' stroke='rgba(255,255,255,0.08)' stroke-width='3' fill='none' stroke-linecap='round'/%3E%3Ctext x='50' y='180' text-anchor='middle' fill='rgba(255,255,255,0.1)' font-size='8' font-family='system-ui'%3E업로드 → 테이블 → 편집%3C/text%3E%3C/svg%3E") no-repeat center;
            background-size: contain;
            z-index: 2;
            pointer-events: none;
        }

        body::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: -10%;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(255,255,255,0.04) 0%, transparent 70%);
            border-radius: 50%;
            z-index: 1;
        }
        
        .app-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            position: relative;
            z-index: 10;
        }
        
        /* 상단 헤더 - 슬림화 */
        .app-header {
            background: linear-gradient(135deg, #1E3A8A 0%, #3B82F6 100%);
            color: white;
            padding: 18px 30px;
            position: relative;
            box-shadow: 0 4px 20px rgba(30, 58, 138, 0.2);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .app-branding {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .app-title {
            font-size: 28px;
            font-weight: 700;
            color: white;
            margin: 0;
            letter-spacing: -0.5px;
        }
        
        .app-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.85);
            font-weight: 500;
            margin: 0;
        }

        /* 헤더 컨트롤 버튼들 */
        .header-controls {
            display: flex;
            gap: 12px;
            z-index: 100;
        }

        .header-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .header-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .logout-btn {
            background: rgba(107, 114, 128, 0.8);
            border-color: rgba(107, 114, 128, 0.8);
        }

        .logout-btn:hover {
            background: rgba(107, 114, 128, 1);
            border-color: rgba(107, 114, 128, 1);
        }
        
        /* 메인 컨텐츠 */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* 입력 영역 */
        .input-section {
            background: white;
            padding: 25px 30px;
            border-bottom: 1px solid #e5e7eb;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .input-section.collapsed {
            padding: 12px 30px;
        }

        /* 단계별 가이드를 상단으로 이동 */
        .step-guide-top {
            display: flex;
            gap: 12px;
            padding: 12px 20px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 25px;
            font-size: 12px;
            color: #1E3A8A;
            font-weight: 600;
            margin-bottom: 20px;
            justify-content: center;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .step-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .step-number {
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #3B82F6, #1E3A8A);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 700;
        }
        
        .input-content {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
            display: flex;
            gap: 30px;
            align-items: center;
        }
        
        .input-text-area {
            flex: 2;
            max-width: 600px;
        }
        
        .input-buttons-area {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
            min-width: 160px;
            max-width: 160px;
            position: relative;
        }
        
        .input-content.collapsed {
            display: none;
        }
        
        .input-area {
            width: 100%;
            height: 300px;  /* 초기값은 120px */ 
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            font-size: 13px;
            resize: none;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
            line-height: 1.6;
            margin-bottom: 12px;
        }
        
        .input-area:focus {
            outline: none;
            border-color: #3B82F6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            transform: translateY(-1px);
        }
        
        .input-area::placeholder {
            color: #9CA3AF;
            font-style: normal;
        }
        
        /* 진행률 바 숨김 */
        .file-status {
            display: none;
        }
        
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 100%;
        }
        
        .file-input {
            display: none;
        }
        
        .file-btn {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            color: #6B7280;
            border: 2px solid #e5e7eb;
            padding: 14px 16px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 400;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            text-align: center;
        }
        
        .file-btn:hover {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            border-color: #cbd5e1;
            color: #475569;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .generate-btn {
            background: linear-gradient(135deg, #3B82F6 0%, #1E3A8A 100%);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 400;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            text-align: center;
        }
        
        .generate-btn:hover {
            background: linear-gradient(135deg, #1E3A8A 0%, #1E40AF 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }
        
        /* 툴바 - 초기에는 숨김 */
        .toolbar {
            display: none;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-bottom: 1px solid #e5e7eb;
            padding: 16px 30px;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        /* 툴바가 보일 때 */
        .toolbar.show {
            display: flex;
        }
        
        .toolbar-left {
            display: none;
        }
        
        .toolbar-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .toolbar-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .toolbar-input {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 13px;
            width: 120px;
            background: white;
            transition: all 0.3s ease;
        }
        
        .toolbar-input:focus {
            outline: none;
            border-color: #3B82F6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .toolbar-btn {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            color: #475569;
            border: 1px solid #e2e8f0;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 400;
            white-space: nowrap;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .toolbar-btn:hover {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        }
        
        .toolbar-btn.primary {
            background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%);
            color: white;
            border: none;
            box-shadow: 0 2px 6px rgba(59, 130, 246, 0.3);
        }
        
        .toolbar-btn.primary:hover {
            background: linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .toolbar-btn.success {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            color: white;
            border: none;
            box-shadow: 0 2px 6px rgba(5, 150, 105, 0.3);
        }
        
        .toolbar-btn.success:hover {
            background: linear-gradient(135deg, #047857 0%, #065F46 100%);
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.4);
        }

        .toolbar-btn.special {
            background: linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%);
            color: white;
            border: none;
            box-shadow: 0 3px 12px rgba(124, 58, 237, 0.4);
            position: relative;
            overflow: hidden;
            font-weight: 400;
        }

        .toolbar-btn.special::before {
            content: '⭐';
            position: absolute;
            top: -2px;
            right: -2px;
            font-size: 12px;
            animation: sparkle 2s infinite;
        }

        .toolbar-btn.special:hover {
            background: linear-gradient(135deg, #5B21B6 0%, #4C1D95 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(124, 58, 237, 0.5);
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }
        
        .toolbar-btn.warning {
            background: linear-gradient(135deg, #D97706 0%, #B45309 100%);
            color: white;
            border: none;
            box-shadow: 0 2px 6px rgba(217, 119, 6, 0.3);
        }
        
        .toolbar-btn.warning:hover {
            background: linear-gradient(135deg, #B45309 0%, #92400E 100%);
            box-shadow: 0 4px 12px rgba(217, 119, 6, 0.4);
        }
        
        .toolbar-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .toolbar-separator {
            color: #cbd5e1;
            margin: 0 8px;
            font-size: 14px;
        }
        
        /* 테이블 영역 - 초기에는 숨김 */
        .table-section {
            display: none;
            flex: 1;
            overflow: hidden;
            background: white;
            margin: 20px 30px 30px 30px;
            border: 1px solid #e5e7eb;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }
        
        /* 테이블이 보일 때 */
        .table-section.show {
            display: flex;
            flex-direction: column;
        }
        
        .table-container {
            height: 100%;
            overflow: auto;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            color: #374151;
            padding: 16px 12px;
            text-align: center;
            border-bottom: 2px solid #e5e7eb;
            position: sticky;
            top: 0;
            z-index: 10;
            font-weight: 700;
            font-size: 13px;
        }
        
        .comparison-table td {
            padding: 12px;
            border-bottom: 1px solid #f3f4f6;
            vertical-align: top;
            line-height: 1.6;
        }
        
        .paragraph-num {
            width: 80px;
            text-align: center;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            font-weight: 700;
            color: #6B7280;
            cursor: pointer;
            font-size: 12px;
            border-right: 1px solid #e5e7eb;
        }
        
        .paragraph-num:hover {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            color: #374151;
        }
        
        .text-cell {
            width: calc(50% - 40px);
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 12px 16px;
        }
        
        .text-cell:hover {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }
        
        .text-cell.editing {
            padding: 0;
        }
        
        .inline-editor {
            width: 100%;
            border: 2px solid #3B82F6;
            border-radius: 8px;
            padding: 12px;
            font-size: 13px;
            line-height: 1.6;
            resize: vertical;
            min-height: 60px;
            font-family: inherit;
            background: white;
        }
        
        .inline-editor:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .edit-buttons {
            margin-top: 8px;
            text-align: right;
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }
        
        .edit-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .edit-btn.save {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(5, 150, 105, 0.3);
        }

        .edit-btn.save:hover {
            background: linear-gradient(135deg, #047857 0%, #065F46 100%);
            transform: translateY(-1px);
        }
        
        .edit-btn.cancel {
            background: linear-gradient(135deg, #6B7280 0%, #4B5563 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(107, 114, 128, 0.3);
        }

        .edit-btn.cancel:hover {
            background: linear-gradient(135deg, #4B5563 0%, #374151 100%);
            transform: translateY(-1px);
        }
        
        /* 하이라이트 효과 */
        .highlight-change {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            animation: highlight-fade 2s ease-out;
        }
        
        @keyframes highlight-fade {
            0% { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
            100% { background: transparent; }
        }
        
        .highlight-search {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            color: #92400e;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 700;
        }
        
        .word-changed {
            color: #dc2626 !important;
            font-weight: 700 !important;
            background: linear-gradient(135deg, #ffeb3b 0%, #fdd835 100%) !important;
            padding: 3px 6px !important;
            border-radius: 4px !important;
        }
        
        .particle-changed {
            color: #dc2626 !important;
            font-weight: 700 !important;
            background: linear-gradient(135deg, #ffeb3b 0%, #fdd835 100%) !important;
            padding: 3px 6px !important;
            border-radius: 4px !important;
            text-decoration: underline;
        }
        
        .word-added {
            color: #059669 !important;
            font-weight: 700 !important;
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%) !important;
            padding: 3px 6px !important;
            border-radius: 4px !important;
        }
        
        .word-deleted {
            color: #dc2626 !important;
            font-weight: 700 !important;
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%) !important;
            padding: 3px 6px !important;
            border-radius: 4px !important;
            text-decoration: line-through;
        }
        
        /* 빈 상태 */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #6B7280;
            padding: 60px 40px;
            position: relative;
        }
        
        .empty-icon {
            font-size: 48px;
            margin-bottom: 20px;
            opacity: 0.7;
            background: linear-gradient(135deg, #3B82F6, #1E3A8A);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .empty-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 12px;
            color: #374151;
        }
        
        .empty-subtitle {
            font-size: 14px;
            text-align: center;
            max-width: 350px;
            line-height: 1.6;
            color: #6B7280;
        }
        
        /* 반응형 디자인 */
        @media (max-width: 1024px) {
            .toolbar {
                flex-direction: column;
                gap: 12px;
                align-items: center;
            }
            
            .toolbar-right {
                justify-content: center;
                flex-wrap: wrap;
            }

            .input-content {
                flex-direction: column;
                gap: 16px;
            }

            .input-buttons-area {
                min-width: auto;
                max-width: none;
            }

            .action-buttons {
                flex-direction: row;
                gap: 12px;
                justify-content: center;
            }

            .file-btn, .generate-btn {
                flex: 1;
                min-width: 0;
            }
        }
        
        @media (max-width: 768px) {
            .app-header {
                padding: 15px;
                flex-direction: column;
                align-items: center;
                text-align: center;
                gap: 12px;
            }

            .app-branding {
                flex-direction: column;
                gap: 6px;
                text-align: center;
            }

            .header-controls {
                justify-content: center;
            }
            
            .input-section {
                padding: 20px 15px;
            }
            
            .toolbar {
                padding: 15px;
            }
            
            .table-section {
                margin: 15px 15px 20px 15px;
                border-radius: 12px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .toolbar-right {
                gap: 12px;
            }

            .toolbar-group {
                gap: 6px;
            }

            .toolbar-input {
                width: 100px;
            }

            .step-guide-top {
                padding: 8px 12px;
                font-size: 11px;
                gap: 8px;
            }

            .step-number {
                width: 18px;
                height: 18px;
                font-size: 9px;
            }
        }
        
        /* 커스텀 스크롤바 */
        .table-container::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        .table-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }
        
        .table-container::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #cbd5e1, #94a3b8);
            border-radius: 4px;
        }
        
        .table-container::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #94a3b8, #64748b);
        }

        /* Firefox 스크롤바 */
        .table-container {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 #f1f5f9;
        }
    </style>

    <!-- Firebase 인증 보호 스크립트 -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js';
        import { 
            getAuth, 
            onAuthStateChanged, 
            setPersistence,
            browserSessionPersistence
        } from 'https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js';
        import { 
            getFirestore, 
            doc, 
            getDoc 
        } from 'https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBbDLYn9SRGXjvUh_SFrlUBX4wYBcdln9k",
            authDomain: "smart-eac10.firebaseapp.com",
            projectId: "smart-eac10",
            storageBucket: "smart-eac10.firebasestorage.app",
            messagingSenderId: "989426802509",
            appId: "1:989426802509:web:c0c70a856810f8b9ac2104",
            measurementId: "G-LT29P3YTT2"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        setPersistence(auth, browserSessionPersistence)
          .then(() => {
            console.log('SMARTPAT 세션 설정 완료');
          })
          .catch((error) => {
            console.error('세션 설정 오류:', error);
          });
        
       function createLoadingOverlay() {    
           const overlay = document.createElement('div');
           overlay.id = 'auth-loading-overlay';
           overlay.style.cssText = `
               position: fixed;
               top: 0;
               left: 0;
               width: 100%;
              height: 100%;
              background: rgba(30, 58, 138, 0.95);
              backdrop-filter: blur(10px);
              display: flex;
              flex-direction: column;
              justify-content: center;
              align-items: center;
            z-index: 10000;
             font-family: 'Segoe UI', sans-serif;
         `;
         
         overlay.innerHTML = `
             <div style="text-align: center; color: white;">
                 <div style="width: 60px; height: 60px; border: 4px solid rgba(255,255,255,0.3); border-top: 4px solid white; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 25px;"></div>
                 <h2 style="color: white; margin-bottom: 12px; font-size: 24px; font-weight: 700;">SMARTPAT</h2>
                 <p style="color: rgba(255,255,255,0.9); font-size: 16px;">인증 확인 중...</p>
             </div>
             <style>
                 @keyframes spin {
                     0% { transform: rotate(0deg); }
                     100% { transform: rotate(360deg); }
                 }
             </style>
         `;
         
         document.body.appendChild(overlay);
     }

     function removeLoadingOverlay() {
         const overlay = document.getElementById('auth-loading-overlay');
         if (overlay) {
             overlay.remove();
         }
     }

     function redirectToLogin() {
         window.location.href = '/login.html';
     }

     async function checkUserApproval(user) {
         try {
             const userDoc = doc(db, 'users', user.uid);
             const userSnapshot = await getDoc(userDoc);
             
             if (userSnapshot.exists()) {
                 const userData = userSnapshot.data();
                 return userData.status === 'approved';
             }
             return false;
         } catch (error) {
             console.error('사용자 승인 상태 확인 오류:', error);
             return false;
         }
     }

     function showPendingApproval() {
         document.body.innerHTML = `
             <div style="
                 min-height: 100vh;
                 display: flex;
                 flex-direction: column;
                 justify-content: center;
                 align-items: center;
                 background: linear-gradient(135deg, #1E3A8A 0%, #3B82F6 100%);
                 font-family: 'Segoe UI', sans-serif;
                 color: white;
                 text-align: center;
                 padding: 2rem;
             ">
                 <div style="
                     background: rgba(255, 255, 255, 0.95);
                     backdrop-filter: blur(20px);
                     color: #333;
                     padding: 3rem;
                     border-radius: 24px;
                     box-shadow: 0 25px 50px rgba(30, 58, 138, 0.3);
                     max-width: 500px;
                     border: 1px solid rgba(255, 255, 255, 0.2);
                 ">
                     <h1 style="color: #1E3A8A; margin-bottom: 1rem; font-size: 28px; font-weight: 700;">SMARTPAT</h1>
                     <h2 style="margin-bottom: 1.5rem; color: #374151;">승인 대기 중</h2>
                     <p style="margin-bottom: 2rem; line-height: 1.6; color: #6B7280;">
                         베타 테스트 신청이 접수되었습니다.<br>
                         관리자 승인 후 서비스를 이용하실 수 있습니다.<br><br>
                         승인 완료 시 이메일로 알림을 드릴 예정입니다.
                     </p>
                     <button onclick="window.location.href='/login.html'" style="
                         background: linear-gradient(135deg, #3B82F6 0%, #1E3A8A 100%);
                         color: white;
                         border: none;
                         padding: 12px 24px;
                         border-radius: 12px;
                         font-size: 16px;
                         font-weight: 600;
                         cursor: pointer;
                         transition: all 0.3s;
                         box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
                     " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(59, 130, 246, 0.4)'" 
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(59, 130, 246, 0.3)'">
                         다시 로그인
                     </button>
                 </div>
             </div>
         `;
     }

     function initializeAuth() {
         createLoadingOverlay();
         
         onAuthStateChanged(auth, async (user) => {
             if (user) {
                 console.log('SMARTPAT 로그인된 사용자:', user);
                 
                 const isApproved = await checkUserApproval(user);
                 
                 if (isApproved) {
                     console.log('승인된 사용자 - SMARTPAT 서비스 접근 허용');
                     removeLoadingOverlay();
                 } else {
                     console.log('승인되지 않은 사용자');
                     showPendingApproval();
                 }
             } else {
                 console.log('로그인되지 않은 사용자 - 로그인 페이지로 리다이렉트');
                 redirectToLogin();
             }
         });
     }

     if (document.readyState === 'loading') {
         document.addEventListener('DOMContentLoaded', initializeAuth);
     } else {
         initializeAuth();
     }

     // 전역 auth 객체 설정 (로그아웃 버튼에서 사용)
     window.auth = auth;
 </script>
 
</head>
<body>
 <div class="app-container">
     <!-- 상단 헤더 -->
     <header class="app-header">
         <!-- 브랜딩 영역 -->
         <div class="app-branding">
              <h1 class="app-title">
                <a href="index.html" style="color: inherit; text-decoration: none; cursor: pointer;">SMARTPAT</a>
             </h1>
             <p class="app-subtitle">스마트 보정 플랫폼</p>
         </div>
         
         <!-- 헤더 컨트롤 버튼들 -->
         <div class="header-controls">
             <button id="toggleInputBtn" class="header-btn">접기</button>
             <button id="logoutBtn" class="header-btn logout-btn">로그아웃</button>
         </div>
     </header>
     
     <div class="main-content">
         <!-- 입력 영역 -->
         <div class="input-section" id="inputSection">
             <!-- 단계별 가이드를 상단으로 이동 -->
             <div class="step-guide-top">
                 <div class="step-item">
                     <div class="step-number">1</div>
                     <span>파일 업로드</span>
                 </div>
                 →
                 <div class="step-item">
                     <div class="step-number">2</div>
                     <span>비교 테이블 생성</span>
                 </div>
                 →
                 <div class="step-item">
                     <div class="step-number">3</div>
                     <span>편집 & 다운로드</span>
                 </div>
             </div>
             
             <div class="input-content" id="inputContent">
                 <div class="input-text-area">
                     <div class="file-status" id="fileStatus"></div>
                     <textarea class="input-area" id="originalText" 
                     placeholder="명세서 파일(word, txt)을 업로드하거나, 여기에 파일을 드래그&드랍하세요!"></textarea>
                 </div>
                 
                 <div class="input-buttons-area">
                     <div class="action-buttons">
                         <input type="file" class="file-input" id="fileInput" accept=".docx,.txt">
                         <button class="file-btn" id="fileBtn">📎 파일 업로드</button>
                         <button class="generate-btn" id="generateBtn">비교 테이블 생성</button>
                     </div>
                 </div>
             </div>
         </div>
         
         <!-- 툴바 -->
         <div class="toolbar">
             <div class="toolbar-left" id="toolbarMessage">
                 <!-- 메시지 제거됨 -->
             </div>
             
             <div class="toolbar-right">
                 <div class="toolbar-group">
                     <input type="text" class="toolbar-input" id="searchInput" placeholder="찾기">
                     <button class="toolbar-btn primary" id="findBtn">찾기</button>
                 </div>
                 
                 <span class="toolbar-separator">|</span>
                 
                 <div class="toolbar-group">
                     <input type="text" class="toolbar-input" id="replaceInput" placeholder="바꾸기">
                     <button class="toolbar-btn success" id="replaceAllBtn">일괄변경</button>
                 </div>
                 
                 <span class="toolbar-separator">|</span>
                 
                 <div class="toolbar-group">
                     <button class="toolbar-btn" id="undoBtn">↶ 실행취소</button>
                     <button class="toolbar-btn" id="redoBtn">↷ 다시실행</button>
                 </div>
                 
                 <span class="toolbar-separator">|</span>
                 
                 <div class="toolbar-group">
                     <button class="toolbar-btn special" id="claimCheckBtn">⚖️ 청구항 점검</button>
                     <button class="toolbar-btn warning" id="downloadBtn">💾 다운로드</button>
                 </div>
             </div>
         </div>
         
         <!-- 테이블 영역 -->
         <div class="table-section">
             <div class="table-container" id="tableContainer">
                 <div class="empty-state" id="emptyState">
                     <div class="empty-icon">📋</div>
                     <div class="empty-title">비교 테이블이 생성되지 않았습니다</div>
                 </div>
             </div>
         </div>
     </div>
 </div>

 <!-- mammoth 라이브러리 로드 -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
 <script src="amendment-checker.js"></script>

 <!-- 헤더 버튼 기능 -->
 <script>
 document.addEventListener('DOMContentLoaded', function() {
     const toggleInputBtn = document.getElementById('toggleInputBtn');
     const logoutBtn = document.getElementById('logoutBtn');
     
     // 접기/펼치기 버튼 기능
     if (toggleInputBtn) {
         toggleInputBtn.addEventListener('click', function() {
             const inputSection = document.getElementById('inputSection');
             const inputContent = document.getElementById('inputContent');
             
             if (inputContent && inputSection) {
                 const isCollapsed = inputContent.classList.contains('collapsed');
                 
                 if (isCollapsed) {
                     inputContent.classList.remove('collapsed');
                     inputSection.classList.remove('collapsed');
                     toggleInputBtn.textContent = '접기';
                 } else {
                     inputContent.classList.add('collapsed');
                     inputSection.classList.add('collapsed');
                     toggleInputBtn.textContent = '펼치기';
                 }
             }
         });
     }
     
     // 로그아웃 버튼 기능
     if (logoutBtn) {
         logoutBtn.addEventListener('click', function() {
             if (confirm('로그아웃 하시겠습니까?')) {
                 if (typeof auth !== 'undefined' && auth) {
                     auth.signOut().then(() => {
                         console.log('SMARTPAT 로그아웃 완료');
                         window.location.href = '/login.html';
                     }).catch((error) => {
                         console.error('로그아웃 오류:', error);
                         window.location.href = '/login.html';
                     });
                 } else {
                     window.location.href = '/login.html';
                 }
             }
         });
     }
 });
 </script>

 <!-- 보안 스크립트 -->
 <script>
 (function() {
     'use strict';
     
     // 우클릭 방지
     document.addEventListener('contextmenu', function(e) {
         e.preventDefault();
         e.stopPropagation();
         return false;
     });
     
     // 키보드 단축키 방지
     document.addEventListener('keydown', function(e) {
         // F12 방지
         if (e.key === 'F12' || e.keyCode === 123) {
             e.preventDefault();
             e.stopPropagation();
             return false;
         }
         
         // Ctrl + Shift + I (개발자도구) 방지
         if (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.keyCode === 73)) {
             e.preventDefault();
             e.stopPropagation();
             return false;
         }
         
         // Ctrl + Shift + J (콘솔) 방지
         if (e.ctrlKey && e.shiftKey && (e.key === 'J' || e.keyCode === 74)) {
             e.preventDefault();
             e.stopPropagation();
             return false;
         }
         
         // Ctrl + Shift + C (요소 검사) 방지
         if (e.ctrlKey && e.shiftKey && (e.key === 'C' || e.keyCode === 67)) {
             e.preventDefault();
             e.stopPropagation();
             return false;
         }
         
         // Ctrl + U (소스보기) 방지
         if (e.ctrlKey && (e.key === 'U' || e.keyCode === 85)) {
             e.preventDefault();
             e.stopPropagation();
             return false;
         }
         
         // Ctrl + S (저장) 방지
         if (e.ctrlKey && (e.key === 'S' || e.keyCode === 83)) {
             e.preventDefault();
             e.stopPropagation();
             return false;
         }
     });
     
     // 텍스트 선택 방지 (입력 요소 제외)
     document.addEventListener('selectstart', function(e) {
         if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
             return true;
         }
         e.preventDefault();
         return false;
     });
     
     // 드래그 방지
     document.addEventListener('dragstart', function(e) {
         e.preventDefault();
         return false;
     });
     
     // 개발자도구 감지
     let devtools = { opened: false, orientation: null };
     const threshold = 160;
     
     function detectDevTools() {
         if (window.outerHeight - window.innerHeight > threshold || 
             window.outerWidth - window.innerWidth > threshold) {
             if (!devtools.opened) {
                 devtools.opened = true;
                 console.clear();
                 console.log('%cSMARTPAT 개발자도구 사용이 제한되어 있습니다.', 
                     'color: #1E3A8A; font-size: 20px; font-weight: bold;');
             }
         } else {
             devtools.opened = false;
         }
     }
     
     setInterval(detectDevTools, 500);
     
     // 콘솔 차단
     console.log = console.error = console.warn = function() { return; };
     
     // 디버거 차단
     setInterval(function() { debugger; }, 1000);
     
     // iframe 차단
     if (window.self !== window.top) {
         window.top.location = window.self.location;
     }

     // CSS 보안
     const style = document.createElement('style');
     style.textContent = `
         * {
             -webkit-user-select: none !important;
             -moz-user-select: none !important;
             -ms-user-select: none !important;
             user-select: none !important;
         }
         
         input, textarea {
             -webkit-user-select: text !important;
             -moz-user-select: text !important;
             -ms-user-select: text !important;
             user-select: text !important;
         }
         
         @media print {
             * { display: none !important; }
             body::before {
                 content: "SMARTPAT 인쇄가 제한되어 있습니다.";
                 display: block !important;
                 font-size: 24px;
                 text-align: center;
                 margin-top: 50px;
                 color: #1E3A8A;
                 font-weight: bold;
             }
         }
     `;
     document.head.appendChild(style);
 })();
 </script>

 <!-- UI 상태 관리 스크립트 추가 -->
 <script>
 // UI 상태 관리 함수들
 window.showWorkingInterface = function() {
     const toolbar = document.querySelector('.toolbar');
     const tableSection = document.querySelector('.table-section');
     
     if (toolbar) {
         toolbar.classList.add('show');
     }
     if (tableSection) {
         tableSection.classList.add('show');
     }
 };

 window.hideWorkingInterface = function() {
     const toolbar = document.querySelector('.toolbar');
     const tableSection = document.querySelector('.table-section');
     
     if (toolbar) {
         toolbar.classList.remove('show');
     }
     if (tableSection) {
         tableSection.classList.remove('show');
     }
 };
 </script>
</body>
</html>
